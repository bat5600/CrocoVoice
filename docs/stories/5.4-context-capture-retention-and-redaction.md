# Epic 5 — Context Capture, Retention, and Redaction

## Status
InProgress

## Story
**As a** user,
**I want** transparent context capture with clear retention rules,
**so that** I can trust how my data is handled.

## Acceptance Criteria
1. Context signals are explicitly listed and categorized (app name, window title, url, ax/textbox, screenshot).
2. Each signal can be enabled/disabled globally and per app.
3. Sensitive signals (ax/textbox, screenshot) are opt-in and off by default.
4. Retention rules are enforced (time-based or size-based) with user controls (default: 30 days).
5. Users can delete all stored context immediately from settings.
6. Redaction rules apply before any sync or AI requests (mask emails, phone numbers, and long numeric sequences).
7. App name + URL are populated for a defined “must support” set (at minimum: Chrome/Chromium browsers for URL domain). When unavailable, the UI explains why (permissions / unsupported app / provider limitation).
8. When screenshots are enabled, the Context surface shows them; screenshots are local-only, never synced, and ephemeral (no long-term storage).

## Tasks / Subtasks
- [x] Add context signal registry and settings UI (AC: 1,2,3)
- [x] Implement retention policy (TTL or size caps) for stored context (AC: 4)
- [x] Add “delete all context” action in settings (AC: 5)
- [x] Implement redaction pipeline before AI/sync (AC: 6)
- [ ] Add OS/browser-specific provider to populate app name + URL where possible (AC: 7)
- [ ] Ensure screenshots display in Context UI when enabled, without persisting long-term (AC: 8)

## Dev Notes
- Default capture: app name, window title, url (when available).
- Optional capture: ax/textbox snapshot, screenshot.
- Never sync screenshots unless explicitly enabled.
- Retention should purge by age first; if size caps are used, purge oldest first.
- Must-support baseline (v1): Chrome/Chromium URL domain capture + clear “unsupported” reasons when unavailable.

### Testing
- Manual: toggle each signal, verify stored data and retention.
- Manual: ensure redaction removes sensitive content.

## Change Log
| Date | Version | Description | Author |
| --- | --- | --- | --- |
| 2026-01-24 | v0.1 | New story for context capture governance | PO |
| 2026-02-01 | v0.2 | Video review: fix app/url “unknown” + show screenshots (ephemeral) | PM |

## Dev Agent Record
### Agent Model Used
GPT-5

### Debug Log References
N/A

### Completion Notes List
- Signaux configurables + rétention 30j + suppression totale du contexte.
- Redaction appliquée avant stockage/sync, contexte stocké en JSON.

### File List
- main.js
- store.js
- sync.js
- dashboard.html
- dashboard.js

## QA Results
