# Epic 6 â€” Upload Flow and Status (Local File Transcription)

## Status
Ready for Review

## Story
**As a** user,
**I want** to upload a long audio file and see processing progress,
**so that** I can transcribe recordings without live dictation.

## Acceptance Criteria
1. The app lets me select a local audio file (wav/mp3/m4a) for transcription.
2. Processing is local by default (no upload); cloud fallback requires explicit opt-in.
3. A progress UI shows stages (queued, processing, completed, failed) and percent where possible.
4. I can cancel a running transcription without crashing the app.
5. Completed transcripts are saved in history with file metadata (name, duration, size).
6. Failures show a clear reason and preserve the original file reference locally.
7. Large files are handled with a configurable size limit (default: 200MB) and clear error messaging.
8. Transcription runs in a background job and does not block the UI thread.

## Tasks / Subtasks
- [x] Add file picker entry point in hub (AC: 1)
- [x] Implement local file transcription pipeline (AC: 2)
- [x] Add progress/status tracking and UI updates (AC: 3)
- [x] Implement cancel flow and cleanup (AC: 4)
- [x] Persist transcript + metadata in history (AC: 5,6)
- [x] Add opt-in cloud fallback toggle and gating (AC: 2)
- [x] Enforce size limits and user-friendly errors (AC: 7)
- [x] Run transcription as a background job (AC: 8)

## Dev Notes
- Local processing should prefer on-device Whisper if available; otherwise fail with a clear message unless cloud fallback is enabled.
- Store a reference to the original file path (local-only) and avoid uploading it without consent.
- Default size limit should be configurable via settings.

### Testing
- Manual: upload small/large files, cancel mid-way, verify history entry.
- Offline: verify local-only path; cloud fallback remains disabled.

## Change Log
| Date | Version | Description | Author |
| --- | --- | --- | --- |
| 2026-01-25 | v0.1 | Reactivated Epic 6 upload flow story | PO |

## Dev Agent Record
### Agent Model Used
GPT-5 (Codex CLI)

### Debug Log References
- node test-core.js

### Completion Notes List
- Added upload picker + queue with cancel/progress UI in the hub.
- Implemented cloud-fallback transcription with size limits and history metadata.
- Redacted local file paths from sync payloads.

### File List
- main.js
- dashboard.html
- dashboard.js
- preload.js
- sync.js

## QA Results
