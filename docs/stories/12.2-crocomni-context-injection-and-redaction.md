# Epic 12 â€” CrocOmni Context Injection and Redaction

## Status
InProgress

## Story
**As a** user,
**I want** CrocOmni to optionally use context safely,
**so that** responses are better without compromising privacy.

## Acceptance Criteria
1. Context injection is opt-in globally and per app.
2. Supported context signals: app name, window title, URL, and optional ax/textbox/screenshot if enabled.
3. Redaction rules are applied before sending any context to providers.
4. UI clearly shows when context is being used for a message.
5. If context capture fails, CrocOmni still responds without blocking.
6. When excerpts/citations are shown in CrocOmni, they are **redacted excerpts only** (no unredacted excerpts by default).

## Tasks / Subtasks
- [x] Add global + per-app context injection toggles for CrocOmni (AC: 1)
- [x] Implement context assembly using existing context capture service (AC: 2)
- [x] Add redaction filters for sensitive content (AC: 3)
- [x] Add UI indicator when context is attached (AC: 4)
- [x] Ensure graceful fallback on capture errors (AC: 5)
- [ ] Ensure excerpt rendering/citations are redacted-only by default (AC: 6)

## Dev Notes
- Reuse Epic 5 context capture settings; CrocOmni should not bypass user privacy choices.
- Keep context payload small (summaries, not raw dumps) unless explicitly enabled.

### Testing
- Manual: toggle context on/off, verify indicator, verify redaction, force capture failure.

## Change Log
| Date | Version | Description | Author |
| --- | --- | --- | --- |
| 2026-01-25 | v0.1 | New story for CrocOmni context injection | PO |
| 2026-02-01 | v0.2 | Video review: CrocOmni excerpts must be redacted-only | PM |

## Dev Agent Record
### Agent Model Used
GPT-5.2-Codex

### Debug Log References
N/A

### Completion Notes List
- Added CrocOmni context toggles, redaction, and UI indicator for context usage.
- Ensured fallback to no-context when capture fails.

### File List
- main.js
- dashboard.js
- dashboard.html

## QA Results
