# Quota Tracking and UI Display - Brownfield Addition

## User Story
As a user,
I want to see my weekly word quota and remaining words,
So that I understand my usage on the FREE plan.

## Story Context

**Existing System Integration:**

- Integrates with: transcription pipeline output (post-process text), dashboard UI
- Technology: Electron (main/renderer), JS, optional Supabase sync
- Follows pattern: existing status updates and UI badges
- Touch points: transcription completion handler, UI render for account status

## Acceptance Criteria

**Functional Requirements:**

1. Weekly quota is defined as 2000 words with reset at Monday 00:00 UTC.
2. Word usage is counted from final text (post-process), not audio duration.
3. UI displays remaining words and next reset timestamp in the dashboard in a visible, consistent location.

**Integration Requirements:**
4. Existing dictation flow continues to work when quota is below limit.
5. Quota usage is stored in Supabase (per-user) without SQLite schema changes.
6. Integration with Supabase user identity is preserved (per-user quota).

**Quality Requirements:**
7. Change is covered by appropriate tests or manual verification steps.
8. Documentation is updated if needed (PRD/story refs).
9. No regression in existing functionality verified.

## Technical Notes

- **Integration Approach:** Increment weekly usage counter after each successful transcription; store and read from Supabase per-user record.
- **Existing Pattern Reference:** Current status messaging and user identity handling (Supabase user id/email).
- **Key Constraints:** Do not add new frameworks; keep logic in main/renderer JS.

## Definition of Done

- [ ] Functional requirements met
- [ ] Integration requirements verified
- [ ] Existing functionality regression tested
- [ ] Code follows existing patterns and standards
- [ ] Tests pass (existing and new)
- [ ] Documentation updated if applicable

## Risk and Compatibility Check

**Minimal Risk Assessment:**

- **Primary Risk:** Incorrect word count or reset window causing user confusion.
- **Mitigation:** Use a single helper for word counting and reset timestamp calculation.
- **Rollback:** Disable quota display while keeping counters intact.

**Compatibility Verification:**

- [ ] No breaking changes to existing APIs
- [ ] Database changes (if any) are additive only
- [ ] UI changes follow existing design patterns
- [ ] Performance impact is negligible

## Validation Checklist

**Scope Validation:**

- [ ] Story can be completed in one development session
- [ ] Integration approach is straightforward
- [ ] Follows existing patterns exactly
- [ ] No design or architecture work required

**Clarity Check:**

- [ ] Story requirements are unambiguous
- [ ] Integration points are clearly specified
- [ ] Success criteria are testable
- [ ] Rollback approach is simple
