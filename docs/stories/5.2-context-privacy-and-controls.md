# Epic 5 - Context Privacy and Controls

## Status
InProgress

## Story
**As a** user,
**I want** clear privacy controls for contextual awareness,
**so that** I can enable or disable it confidently.

## Acceptance Criteria
1. A global toggle enables/disables contextual awareness across the app.
2. Users can override behavior per app (force on/off or choose a profile).
3. The UI explains which signals are used (app/window/url/ax/screenshot) and their defaults.
4. Sensitive signals (ax/textbox, screenshot) require explicit opt-in; when enabling Context for the first time, the UI asks for screenshot consent (recommended ON) and explains “local-only, never synced, ephemeral”.
5. Disabling contextual awareness preserves the standard formatting pipeline.
6. Settings changes apply immediately and persist locally.
7. Per-app overrides can be set to: inherit global, force off, or force on with a specific profile.
8. The settings UI clearly shows what will be captured for the active app.

## Tasks / Subtasks
- [x] Add global contextual awareness toggle to settings (AC: 1,4,5)
- [x] Add per-app overrides in profile settings (AC: 2,5)
- [x] Add privacy copy explaining signals and data handling (AC: 3,4)
- [x] Ensure toggles affect the pipeline at runtime (AC: 5,6)
- [x] Add per-app override modes (inherit/off/on + profile) (AC: 7)
- [x] Add active-app preview of enabled signals (AC: 8)
- [x] Add explicit first-time Context enable consent UX for screenshots (recommended ON; local-only; never synced; ephemeral) (AC: 4)

## Dev Notes
- Default to minimal context (app/window/url). Sensitive signals require opt-in.
- Keep language clear and non-technical in the UI.
- Store overrides in settings with a stable key (e.g., `context.overrides[appId]`).

### Testing
- Manual: toggle global switch and confirm formatting reverts to default.
- Manual: per-app override supersedes global setting.

## Change Log
| Date | Version | Description | Author |
| --- | --- | --- | --- |
| 2026-01-20 | v0.1 | Story created from global PRD Epic 5 shard plan | PO |
| 2026-02-01 | v0.2 | Video review: Context default OFF + explicit screenshot consent UX | PM |
| 2026-02-01 | v0.3 | Implemented first-time screenshot consent UX | Dev |

## Dev Agent Record
### Agent Model Used
GPT-5

### Debug Log References
N/A

### Completion Notes List
- UI Context avec toggles globaux + overrides par app (modes + profil).
- Les changements sont persistés immédiatement et appliqués à la pipeline.
- Consentement explicite lors du premier ON avec option screenshot recommandée + mention local-only/never synced/ephemeral.

### File List
- main.js
- dashboard.js


## QA Results
